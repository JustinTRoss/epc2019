{"remainingRequest":"/Users/maxp8108/esridev/epc2019/cost/node_modules/babel-loader/lib/index.js??ref--4-1!/Users/maxp8108/esridev/epc2019/cost/src/components/MapComponent.js","dependencies":[{"path":"/Users/maxp8108/esridev/epc2019/cost/src/components/MapComponent.js","mtime":1551225823313},{"path":"/Users/maxp8108/esridev/epc2019/cost/.babelrc","mtime":1551564672042},{"path":"/Users/maxp8108/esridev/epc2019/cost/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/maxp8108/esridev/epc2019/cost/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["define([\"exports\", \"react\", \"esri/views/MapView\", \"esri/widgets/LayerList\", \"esri/widgets/Search\", \"esri/layers/FeatureLayer\", \"esri/tasks/RouteTask\", \"esri/tasks/support/RouteParameters\", \"esri/tasks/support/FeatureSet\", \"esri/tasks/Locator\"], function (exports, _react, _MapView, _LayerList, _Search, _FeatureLayer, _RouteTask, _RouteParameters, _FeatureSet, _Locator) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _react2 = _interopRequireDefault(_react);\n\n  var _MapView2 = _interopRequireDefault(_MapView);\n\n  var _LayerList2 = _interopRequireDefault(_LayerList);\n\n  var _Search2 = _interopRequireDefault(_Search);\n\n  var _FeatureLayer2 = _interopRequireDefault(_FeatureLayer);\n\n  var _RouteTask2 = _interopRequireDefault(_RouteTask);\n\n  var _RouteParameters2 = _interopRequireDefault(_RouteParameters);\n\n  var _FeatureSet2 = _interopRequireDefault(_FeatureSet);\n\n  var _Locator2 = _interopRequireDefault(_Locator);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _typeof(obj) {\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  var MapComponent = function (_PureComponent) {\n    _inherits(MapComponent, _PureComponent);\n\n    function MapComponent(props) {\n      var _this;\n\n      _classCallCheck(this, MapComponent);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(MapComponent).call(this, props));\n      _this.viewRef = _react2.default.createRef();\n      _this.btnRef = _react2.default.createRef();\n      _this.routeToUSPS = _this.routeToUSPS.bind(_assertThisInitialized(_this));\n      _this.view = null;\n      return _this;\n    }\n\n    _createClass(MapComponent, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        var _this2 = this;\n\n        this.view = new _MapView2.default({\n          map: this.props.map,\n          container: this.viewRef.current,\n          center: [-118.40877, 34.00401],\n          zoom: 9,\n          constraints: {\n            snapToZoom: false\n          },\n          highlightOptions: {\n            color: \"#ffffff\",\n            fillOpacity: 0.17\n          }\n        });\n        this.view.when(function () {\n          _this2.props.onLoad(_this2.view);\n        });\n        this.view.ui.move('zoom', 'top-right');\n        this.view.popup.actions = [{\n          title: \"Get route\",\n          id: \"route\",\n          className: \"esri-icon-polyline\"\n        }];\n        this.view.popup.dockOptions = {\n          buttonEnabled: false\n        };\n        this.view.popup.on('trigger-action', this.routeToUSPS);\n        this.addSearchWidget();\n        var layerList = new _LayerList2.default({\n          view: this.view\n        });\n      }\n    }, {\n      key: \"addSearchWidget\",\n      value: function addSearchWidget() {\n        this.searchWidget = new _Search2.default({\n          view: this.view,\n          popupEnabled: false,\n          includeDefaultSources: false,\n          sources: [{\n            locator: new _Locator2.default({\n              url: \"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer\"\n            }),\n            singleLineFieldName: \"SingleLine\",\n            outFields: [\"Addr_type\"],\n            localSearchOptions: {\n              minScale: 300000,\n              distance: 50000\n            },\n            placeholder: \"Find address or place\",\n            resultSymbol: {\n              type: \"text\",\n              color: [255, 255, 255],\n              text: \"\\uE61D\",\n              font: {\n                size: 20,\n                family: 'calcite-web-icons'\n              }\n            }\n          }]\n        });\n\n        this.searchWidget.goToOverride = function (view, goToParams) {\n          goToParams.target.zoom = 10;\n          return view.goTo(goToParams.target, goToParams.options);\n        };\n\n        this.searchWidget.on('select-result', this.props.onSelectSearch);\n        this.view.ui.add(this.searchWidget, {\n          position: \"top-right\",\n          index: 0\n        });\n      }\n    }, {\n      key: \"routeToUSPS\",\n      value: function routeToUSPS(evt) {\n        var _this3 = this;\n\n        // console.log(evt.target.features[0]);\n        // return;\n        this.props.onGetRoute();\n        var routeTask = new _RouteTask2.default({\n          url: \"https://utility.arcgis.com/usrsvcs/appservices/fE52CVgQJMKQ6c89/rest/services/World/Route/NAServer/Route_World/solve\"\n        });\n        var start = this.searchWidget.resultGraphic;\n        var end = evt.target.features[0];\n        var routeParams = new _RouteParameters2.default({\n          stops: new _FeatureSet2.default()\n        });\n        routeParams.stops.features.push(start);\n        routeParams.stops.features.push(end);\n        routeTask.solve(routeParams).then(function (data) {\n          var route = data.routeResults[0].route;\n          route.symbol = {\n            type: \"simple-line\",\n            width: 3,\n            color: [255, 255, 255]\n          };\n\n          _this3.view.graphics.add(route);\n\n          _this3.view.popup.close();\n        });\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        return _react2.default.createElement(\"div\", {\n          style: {\n            width: \"100%\",\n            height: \"100%\"\n          }\n        }, _react2.default.createElement(\"div\", {\n          style: {\n            width: \"100%\",\n            height: \"100%\",\n            backgroundColor: \"#373938\"\n          },\n          ref: this.viewRef\n        }));\n      }\n    }]);\n\n    return MapComponent;\n  }(_react.PureComponent);\n\n  exports.default = MapComponent;\n});",null]}