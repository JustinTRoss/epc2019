{"version":3,"sources":["config.js","components/common.js","components/MapComponent.js","components/QuestionHeader.js","components/Slider.js","components/steps/LiveAreas.js","components/steps/Demographic.js","components/App.js","serviceWorker.js","index.js"],"names":["loaderOptions","url","poiRenderer","type","symbol","style","color","size","outline","width","visualVariables","field","legendOptions","title","minSize","maxSize","minDataValue","maxDataValue","highlightOptions","fillOpacity","sumStops","value","label","getBlockCountRenderer","time","arguments","length","undefined","defaultRenderer","stops","opcVV","v","gap","steps","push","opacity","showLegend","getTimeOpcStops","getTimeFilter","where","concat","Math","round","getBlockHlFilter","highlight","MapComponent","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","viewRef","React","createRef","view","_onViewLoaded","bind","assertThisInitialized","_handleMapPointer","_handleClick","state","selPoi","_this2","loadModules","then","_ref","_ref2","slicedToArray","Map","MapView","FeatureLayer","Legend","map","basemap","container","current","center","zoom","constraints","snapToZoom","ui","move","popup","actions","blockLyr","renderer","outFields","poiLyr","addMany","legend","layerInfos","layer","layout","add","vP","when","_","mapView","blockDenseLyr","referenceDotValue","referenceScale","scale","unit","attributes","valueExpression","whenLayerView","catch","er","console","log","bP","pP","Promise","all","evt","_this3","hitTestPromise","cancel","hitTest","hit","res","results","filter","r","graphic","_this4","active","explore","stopPropagation","_handleEvt","poi","remove","onPoiChange","poiLV","_this5","visible","denseLV","getBlockTimeHlFilter","lyrView","effect","insideEffect","outsideEffect","getBlockHlEffect","_ref4","_ref3","lV","onLoad","_setFilters","on","_initMap","react_default","a","createElement","height","backgroundColor","ref","PureComponent","ExtendedButton","styled","Button","_templateObject","QuestionHeader","index","onClick","className","key","white","clearWhite","extraSmall","MySlider","minMax","disabled","defaultTitle","leftLabel","rightLabel","onSlide","float","marginTop","Slider_default","display","min","max","onChange","InfText","CalciteH4","LiveAreas_templateObject","H","CalciteH3","_templateObject2","ExpBtn","_templateObject3","LiveAreas","text","textAlign","fontWeight","getMonthFromTime","large","icon","PinIcon_default","filled","components_Slider","Demographic_templateObject","Demographic_templateObject2","statQuery","onStatisticField","outStatisticFieldName","statisticType","getQuery","wpoi","wtime","groupByFieldsForStatistics","outStatistics","Demographic","lyr","data","features","total","reduce","p","f","wt_sum","vs","TLIFENAME","UA","EE","NW","O","q","queryFeatures","setState","_getChartData","prevProps","prevState","_updateChart","queryObjectIds","labels","datasets","fill","Demographic_InfText","Demographic_ExpBtn","GraphBarIcon_default","es","options","scales","xAxes","stacked","scaleLabel","labelString","ticks","autoSkip","minRotation","maxRotation","padding","yAxes","getElementAtEvent","_onBarClick","CalciteH1","App_templateObject","App_templateObject2","initState","App","onViewLoad","onListItemClick","_onExploreClick","_onTimeSlide","_onPoiChange","loaded","selText","blockLyrView","qKey","next","i","val","fV","parseFloat","target","isActive","components_QuestionHeader","header","getQuestionHeader","Fragment","steps_LiveAreas","steps_Demographic","components_MapComponent","position","top","left","maxHeight","overflowY","getStepOne","getStepTwo","Component","Boolean","window","location","hostname","match","loadCss","defaults","global","defaultFontColor","tooltips","enabled","ReactDOM","render","CalciteThemeProvider_default","components_App","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.0997fefd.chunk.js","sourcesContent":["\n\nconst loaderOptions = {\n  url: 'https://jsdev.arcgis.com/4.11/'\n}\n\nconst poiRenderer = {\n  type: \"simple\",\n  symbol: {\n    type: \"simple-marker\",  // autocasts as new SimpleMarkerSymbol()\n    style: \"diamond\",\n    // color: [0, 171, 189],\n    color: \"#40F99B\" ,\n    // color: [106,255,0],\n    // color: [0, 162, 180],\n    size: \"17px\",  // pixels\n    outline: {  // autocasts as new SimpleLineSymbol()\n      color: [ 0, 0, 0 ],\n      width: 1.5 // points\n    }\n  },\n  visualVariables: [{\n    type: \"size\",\n    field: \"raw_visit_counts\",\n    legendOptions: {title: \"Visit Counts\"},\n    minSize: 4,\n    maxSize: 30,\n    minDataValue: 2000,\n    maxDataValue: 8000\n  }]\n\n}\n\nconst highlightOptions = {\n  color: \"#ffffff\",\n  fillOpacity: 0.17\n}\n\n\n\nexport {loaderOptions, poiRenderer, highlightOptions}","const getMonthFromTime = (time) => {\n  switch(time) {\n    // case 1:\n    //   return \"Feb 2018\"\n    // case 2:\n    //   return \"Mar 2018\"\n    // case 3:\n    //   return \"Apr 2018\"\n    // case 4:\n    //   return \"May 2018\"\n    // case 5:\n    //   return \"Jun 2018\"\n    // case 6:\n    //   return \"Jul 2018\"\n    // case 7:\n    //   return \"Aug 2018\"\n    case 0:\n      return \"Sep 2018\"\n    case 1:\n      return \"Oct 2018\"\n    case 2:\n      return \"Nov 2018\"\n    case 3:\n      return \"Dec 2018\"\n    case 4:\n      return \"Jan 2019\"\n    default:\n      return \"Jan 2019\"\n  }\n}\n\nconst sumStops = [\n  // {\"value\":5,\"color\":[124,61,88,255],\"label\":\"\\u003c 5\"},\n  // {\"value\":10,\"color\":[195,51,129,255],\"label\":null},\n  // {\"value\":15,\"color\":[232,79,166,255],\"label\":\"15\"},\n  // {\"value\":20,\"color\":[236,144,198,255],\"label\":null},\n  // {\"value\":25,\"color\":[255,240,255,255],\"label\":\"\\u003e 25\"}\n  {\"value\":25,\"color\":[214,193,215,255],\"label\":\"\\u003c 5\"},\n  {\"value\":20,\"color\":[215,181,216,255],\"label\":null},\n  {\"value\":15,\"color\":[223,101,176,255],\"label\":\"15\"},\n  {\"value\":10,\"color\":[221,28,119,200],\"label\":null},\n  {\"value\":5,\"color\":[152,0,67,200],\"label\":\"\\u003e 25\"}\n  // {\"value\":24,\"color\":[255,229,240,255],\"label\":\"\\u003c 24\"},\n  // {\"value\":16,\"color\":[215,181,216,255],\"label\":null},\n  // {\"value\":12,\"color\":[223,101,176,255],\"label\":\"12\"},\n  // {\"value\":8,\"color\":[203,26,109,255],\"label\":null},\n  // {\"value\":4,\"color\":[113,18,60,255],\"label\":\"\\u003e 4\"}\n]\n\nconst getTimeOpcStops = (v, gap) => {\n  let steps = [];\n  if(v - gap >= 0) {\n    steps.push({\n      opacity: 0.0,\n      value: v - gap,\n      // label: timeStrFromQuarter(v - gap)\n    })\n  }\n  steps.push({\n    opacity: 1,\n    value: v,\n    // label: timeStrFromQuarter(v)\n  })\n  if(v + gap <= 12){\n    steps.push({\n      opacity: 0.0,\n      value: v + gap,\n      // label: timeStrFromQuarter(v + gap)\n    })\n  }\n  return {\n    type: 'opacity',\n    field: 'time',\n    stops: steps,\n    legendOptions: {showLegend: false}\n  }\n}\n\nconst getBlockCountRenderer = (time=12) => {\n  const defaultRenderer = {\n    type: \"simple\",\n    symbol: {type: \"simple-fill\", outline: {width: 0.1, color: [255,255,255,0.2]}, size: 4, color: 'rgba(255,255,255,0)'},\n    visualVariables: [{\n      type: \"color\",\n      field: \"count_\",\n      stops: sumStops,\n      legendOptions: {title: \"Visit Counts\"}\n    }],\n  }\n  if(!time) return defaultRenderer;\n  const opcVV = getTimeOpcStops(time, 1);\n  defaultRenderer.visualVariables.push(opcVV);\n  return defaultRenderer;\n}\n\n// IIf( condition, trueValue, falseValue ) \nconst getBlockDenseRenderer = (mapView) => {\n  return {\n    type: \"dot-density\",\n    referenceDotValue: 35,\n    outline: null,\n    referenceScale: mapView.scale,\n    legendOptions: {\n      unit: \"visits\"\n    },\n    attributes: [{\n      // field: \"THHGRPL13\",\n      valueExpression: '100 * IIf($feature.TLIFENAME == \"Next Wave\", $feature.count_, 0)',\n      label: \"Next Wave\",\n      color: \"#E3458F\" //dark pink\n    }, {\n      // field: \"THHGRPL2\",\n      valueExpression: '100 * IIf($feature.TLIFENAME == \"Upscale Avenues\", $feature.count_, 0)',\n      label: \"Upscale Avenues\",\n      color: \"#C04CFD\" // purple\n      // color: \"#5E2BFF\" // dark blue\n    }, {\n      // field: \"THHGRPL7\",\n      valueExpression: '100 * IIf($feature.TLIFENAME == \"Ethnic Enclaves\", $feature.count_, 0)',\n      label: \"Ethnic Enclaves\",\n      color: \"#EF8354\" //orange\n    }, {\n      // field: \"THHGRPL11\",\n      // valueExpression: '100 * IIf($feature.TLIFENAME == \"Midtown Singles\", $feature.count_, 0)',\n      // label: \"Midtown Singles\",\n      valueExpression: '100 * IIf(IndexOf([\"Upscale Avenues\", \"Ethnic Enclaves\", \"Next Wave\"], $feature.TLIFENAME) < 0, $feature.count_, 0)',\n      label: \"Other\",\n      // color: \"#40F99B\" // green\n      color: \"#5E2BFF\" // dark blue\n    }]\n  }\n}\n\nconst getTimeFilter = (time=12) => {\n  return {\n    where: `time = ${Math.round(time)}`\n  }\n}\n\nconst getBlockHlFilter = (highlight=null) => {\n  const where = highlight\n    ? `safegraph_place_id = 'sum' OR safegraph_place_id = '${highlight}'`\n    : `safegraph_place_id = 'sum'`;\n  return {\n    where\n  }\n}\n\nconst getBlockTimeHlFilter = (highlight, time) => {\n  const where = `${getTimeFilter(time).where} AND (${getBlockHlFilter(highlight).where})`\n  return {\n    where: where\n  }\n}\n\nconst getBlockHlEffect = (highlight=null) => {\n\n  if(!highlight) return null;\n\n  return {\n    filter: {\n      where: `safegraph_place_id = '${highlight}'`\n    },\n    insideEffect: \"contrast(1.5)\",\n    outsideEffect: \"grayscale(0.5) opacity(60%) contrast(30%)\"\n    // outsideEffect: \"contrast(10%) grayscale(0.8) opacity(1%)\"\n  }\n}\n\nconst hideFilter = {\n  where: `safegraph_place_id = 'note here'`\n}\n\nexport{getMonthFromTime, getBlockCountRenderer, getBlockDenseRenderer,\ngetTimeFilter, getBlockHlFilter, getBlockHlEffect, getBlockTimeHlFilter, hideFilter}","import React, {PureComponent} from 'react';\nimport { loadModules } from 'esri-loader';\nimport { loaderOptions, poiRenderer, highlightOptions } from '../config';\nimport { getBlockCountRenderer, getTimeFilter, getBlockDenseRenderer,\n        getBlockHlFilter, getBlockHlEffect, getBlockTimeHlFilter,\n      hideFilter } from './common'\n\nclass MapComponent extends PureComponent {\n\n  constructor(props){\n    super(props);\n    this.viewRef = React.createRef();\n    this.view = null;\n    this._onViewLoaded = this._onViewLoaded.bind(this);\n    this._handleMapPointer = this._handleMapPointer.bind(this);\n    this._handleClick = this._handleClick.bind(this);\n    this.state = {\n      selPoi: null\n    }\n  }\n\n  _initMap(){\n    loadModules(['esri/Map', 'esri/views/MapView',\n                'esri/layers/FeatureLayer', 'esri/widgets/Legend'], loaderOptions)\n      .then(([Map, MapView, FeatureLayer, Legend]) => {\n        this.map = new Map({\n          basemap: 'dark-gray-vector'\n        })\n\n        this.view = new MapView({\n          map: this.map,\n          container: this.viewRef.current,\n          // center: [-118.34619, 33.95831],\n          center: [-118.26970988458462, 33.93696960332196],\n          zoom: 9.75,\n          constraints: {\n            snapToZoom: false\n          },\n          highlightOptions: highlightOptions\n        })\n        this.view.ui.move('zoom', 'top-right')\n        this.view.popup.actions = [];\n\n        this.blockLyr = new FeatureLayer({\n          // url: \"https://services.arcgis.com/q7zPNeKmTWeh7Aor/arcgis/rest/services/sg_ca_walmart_block_enriched_all_simp/FeatureServer/\",\n          url: \"https://services.arcgis.com/q7zPNeKmTWeh7Aor/arcgis/rest/services/sg_ca_top_block_long_enriched_simp/FeatureServer\",\n          renderer: getBlockCountRenderer(),\n          // outFields: [\"safegraph_place_id\", \"count_\", \"time\"],\n          outFields: [\"safegraph_place_id\", \"count_\", \"time\"]\n        });\n\n        \n\n        this.poiLyr = new FeatureLayer({\n          url: \"https://services.arcgis.com/q7zPNeKmTWeh7Aor/arcgis/rest/services/a07272/FeatureServer\",\n          outFields: [\"safegraph_place_id\", \"raw_visit_counts\", \"time\", \"location_name\"],\n          renderer: poiRenderer\n        })\n        this.map.addMany([this.blockLyr, this.poiLyr]);\n\n        const legend = new Legend({\n          view: this.view,\n          layerInfos: [{\n            layer: this.blockLyr,\n            title: \"Census Blocks\"\n          }, {\n            layer: this.poiLyr,\n            title: \"Stores\"\n          }],\n          style: {\n            // type: \"card\",\n            layout: \"stack\"\n          }\n        })\n        this.view.ui.add(legend, 'bottom-right');\n\n        const vP = this.view.when()\n          .then(_ => {\n            this.blockDenseLyr = new FeatureLayer({\n              url: \"https://services.arcgis.com/q7zPNeKmTWeh7Aor/arcgis/rest/services/sg_ca_top_block_long_enriched_simp/FeatureServer\",\n              renderer: getBlockDenseRenderer(this.view),\n              outFields: [\"safegraph_place_id\", \"count_\", \"time\", \"TLIFENAME\"]\n            });\n            this.map.add(this.blockDenseLyr, 0);\n            legend.layerInfos.push({\n              layer: this.blockDenseLyr,\n              title: \"Census Blocks\"\n            })\n            return this.view.whenLayerView(this.blockDenseLyr);\n          })\n          .catch(er => console.log(er));\n\n        const bP = this.view.whenLayerView(this.blockLyr);\n        const pP = this.view.whenLayerView(this.poiLyr);\n        Promise.all([bP, pP, vP]).then(this._onViewLoaded);\n      \n      })\n      .catch(er => console.log(er));\n  }\n\n  _handleEvt(evt){\n    if(this.hitTestPromise){\n      this.hitTestPromise.cancel();\n    }\n    this.hitTestPromise = this.view.hitTest(evt)\n      .then(hit => {\n        this.hitTestPromise = null;\n        let res = hit.results.filter(r => r.graphic.layer === this.poiLyr);\n        if(res.length){\n          return(res[0].graphic);\n        } else if(this.state.selPoi){\n          return null;\n        }\n      })\n    return this.hitTestPromise;\n  }\n\n  _handleClick(evt){\n    if(!this.props.active[0] || this.props.explore) return;\n    evt.stopPropagation();\n    this._handleEvt(evt, false).then(poi => {\n      if(this.highlight) this.highlight.remove();\n      if(poi){\n        this.props.onPoiChange(poi.attributes['safegraph_place_id'], poi.attributes['location_name']);\n        this.highlight = this.poiLV.highlight(poi);\n      } else {\n        this.props.onPoiChange(null);\n      }\n    })\n  }\n\n  _handleMapPointer(evt){\n    if(!this.props.active[0] || !this.props.explore) return;\n    this._handleEvt(evt, false).then(poi => {\n      if(this.highlight) this.highlight.remove();\n      if(poi){\n        this.props.onPoiChange(poi.attributes['safegraph_place_id'], poi.attributes['location_name']);\n        this.highlight = this.poiLV.highlight(poi);\n      } else {\n        this.props.onPoiChange(null);\n      }\n    })\n  }\n\n  _setFilters(poi=null, time=null){\n    if(this.props.active[1]){\n      \n      this.blockDenseLyr.visible = true;\n      this.blockLyr.visible = false;\n      this.denseLV.filter = getBlockTimeHlFilter(poi, time);\n    } else {\n\n      this.blockDenseLyr.visible = false;\n      this.blockLyr.visible = true;\n\n      this.lyrView.filter = getBlockHlFilter(poi, time);\n      this.blockLyr.renderer = getBlockCountRenderer(time);\n      this.lyrView.effect = getBlockHlEffect(poi);\n      \n    }\n    this.poiLV.filter = getTimeFilter(time);\n  }\n\n  _onViewLoaded([lV, poiLV, denseLV]){\n    this.props.onLoad(this.map, this.view, this.blockDenseLyr, denseLV);\n    this.lyrView = lV;\n    this.poiLV = poiLV;\n    this.denseLV = denseLV;\n    \n    this._setFilters(this.props.poi, this.props.time);\n\n    this.view.on(\"pointer-move\", this._handleMapPointer);\n    this.view.on(\"click\", this._handleClick);\n\n  }\n\n  componentDidMount(){\n    this._initMap();\n  }\n\n  // doesn't update to dot-density when switched\n  render(){\n    if(this.lyrView){\n      this._setFilters(this.props.poi, this.props.time);\n\n    }\n\n    return(\n      <div style={{width: \"100vw\", height: \"100vh\", backgroundColor: \"#373938\"}} ref={this.viewRef}/>\n    )\n  }\n\n}\n\nexport default MapComponent;","import React from 'react';\nimport Button from 'calcite-react/Button';\nimport './question.css'\nimport styled, { css } from 'styled-components';\n\nconst ExtendedButton = styled(Button)`\n  width: 2.5rem;\n  height: 2.5rem;\n  border-radius: 50%;\n  margin: 0.5rem;\n  font-size: 1.69949rem;\n  line-height: 2.325rem;\n`;\n\n\n\nfunction QuestionHeader({title, index, onClick, active}){\n  \n  const className = active ? 'question-panel-active' : 'question-panel';\n  return(\n    <div key={title} style={{color: 'white'}} className={className}>\n      <ExtendedButton\n        white={active}\n        clearWhite={!active}\n        extraSmall\n        onClick={onClick}>\n        {index + 1}\n      </ExtendedButton>\n      {title}\n    </div>\n  )\n\n}\nexport default QuestionHeader;","import React from 'react';\nimport Slider from 'calcite-react/Slider';\n\nfunction MySlider({value, active, disabled, title, defaultTitle, minMax,\n  leftLabel, rightLabel, onClick, onSlide}) {\n    \n  const slider = active ? (\n    <div>\n    <div style={{float: 'left', width: '75px', marginTop: '5px'}}>{leftLabel}</div>\n      <Slider\n        style={{display: 'inline-block', width: 'calc(100% - 160px)'}}\n        min={minMax[0]}\n        max={minMax[1]}\n        value={value}\n        onChange={onSlide}\n      />\n    <div style={{float: 'right', width: '75px', marginTop:'5px'}}>{rightLabel}</div>\n    </div>\n  )\n  : null;\n  return slider;\n}\n\n// 106 255 0 --  darker version (pull V down)\n\nexport default MySlider","import React from 'react';\nimport { CalciteH4, CalciteH3 } from 'calcite-react/Elements';\nimport {getMonthFromTime} from '../common';\nimport styled, { css } from 'styled-components';\nimport Button from 'calcite-react/Button';\nimport Slider from '../Slider';\nimport PinIcon from 'calcite-ui-icons-react/PinIcon';\n\n\nconst InfText = styled(CalciteH4)`\n  color: white;\n  float: left;\n  width: calc(50% - 1rem);\n  margin: 0;\n  padding: 0.5rem;\n`\nconst H = styled(CalciteH3)`\n  color: white;\n  margin: 0;\n  padding: 0.25rem 0rem 0rem 0.5rem;\n`\nconst ExpBtn = styled(Button)`\n  border: None;\n  width: 7rem;\n  margin-left: calc(50% - 7rem);\n  padding-right: 0;\n`\n\nconst LiveAreas = ({active, onClick, value, onSlide, text}) => (\n  \n\n  <div style={{textAlign: \"center\"}}>\n    <div style={{textAlign: \"left\", width: \"100%\"}}>\n      <H style={{fontWeight: 'bold'}}>{text ? text : 'All'}</H>\n      <InfText>{`${getMonthFromTime(Math.round(value/4))}`}</InfText>\n      <ExpBtn\n        clearWhite\n        large\n        icon={<PinIcon filled={active}/>}\n        onClick={onClick}>\n        Explore\n      </ExpBtn>\n    </div>\n    <Slider\n      value={value}\n      active\n      minMax={[1,16]}\n      defaultTitle={'All day'}\n      leftLabel={\"Sep 2018\"}\n      rightLabel={\"Jan 2019\"}\n      onSlide={onSlide}\n    />\n  </div>\n)\nexport default LiveAreas;","import React, {PureComponent} from 'react';\nimport {Bar } from 'react-chartjs-2';\nimport { CalciteH4 } from 'calcite-react/Elements';\nimport Button from 'calcite-react/Button';\nimport styled, { css } from 'styled-components';\nimport GraphBarIcon from 'calcite-ui-icons-react/GraphBarIcon';\n\n\nconst InfText = styled(CalciteH4)`\n  color: white;\n  float: left;\n  width: calc(50% - 1rem);\n  margin: 0;\n  padding: 0.5rem;\n`\nconst ExpBtn = styled(Button)`\n  border: None;\n  width: 8rem;\n  margin-left: calc(50% - 8rem);\n  padding-right: 0;\n`\nconst statQuery = {\n  onStatisticField: `count_`,\n  outStatisticFieldName: `wt_sum`,\n  statisticType: 'sum'\n}\n\n// const statQuery = query.groupByFieldsForStatistics = [ \"region\" ];\n\n// let statQueries = fields.map(f => ({\n//   onStatisticField: `count_`,\n//   outStatisticFieldName: `wt_sum`,\n//   statisticType: 'sum'\n// }))\n// statQueries.push({\n//   onStatisticField: 'count',\n//   outStatisticFieldName: 'countsum',\n//   statisticType: 'sum'\n// })\n\nconst getQuery = (time, poi=null) => {\n  const wpoi = poi\n    ? `safegraph_place_id = '${poi}'`\n    : `safegraph_place_id = 'sum'`;\n  const wtime = `time = ${Math.round(time)}`;\n  const w = `${wpoi} AND ${wtime}`;\n  return {\n    where: w,\n    groupByFieldsForStatistics: 'TLIFENAME',\n    outStatistics: statQuery\n  }\n}\n\n// const getInitQuery = () => {\n//   return {\n//     where: `safegraph_place_id = 'sum'`,\n//     groupByFieldsForStatistics: 'TLIFENAME',\n//     outStatistics: statQuery\n//   }\n// }\n\n\nclass Demographic extends PureComponent {\n  constructor(props){\n    super(props);\n    this.lyr = props.lyr;\n    this.lyrView = props.lyrView;\n\n    this.state = {\n      data: []\n    }\n  }\n\n  _getChartData(res){\n    if(!res || !res.features || !res.features.length) return [];\n    \n    const total = res.features.reduce( (p, f) => {\n      if(!f.attributes.wt_sum) return p;\n      return p + f.attributes.wt_sum;\n    }, 0);\n\n\n    const vs = res.features.reduce( (p, f) => {\n      if(!f.attributes.wt_sum || !f.attributes.TLIFENAME) return p;\n      if(f.attributes.TLIFENAME === 'Upscale Avenues'){\n        p['UA'] += f.attributes.wt_sum / total;\n      } else if (f.attributes.TLIFENAME === 'Ethnic Enclaves'){\n        p['EE'] += f.attributes.wt_sum / total;\n      } else if (f.attributes.TLIFENAME === 'Next Wave'){\n        p['NW'] += f.attributes.wt_sum / total;\n      } else {\n        p['O'] += f.attributes.wt_sum / total;\n      }\n      return p;\n    }, {\n      'UA': 0,\n      'EE': 0,\n      'NW': 0,\n      'O' : 0\n    });\n    \n    return ([\n      vs['NW'],\n      vs['UA'],\n      vs['EE'],\n      vs['O']\n    ])\n\n\n    // console.log(res);\n    // const total = res.features[0].attributes[\"countsum\"];\n    // const vs = fields.map(f => {\n    //   const atr = `${f}_wt_sum`;\n    //   // return res.features[0].attributes[atr] / total;\n    //   return res.features[0].attributes[atr];\n    // });\n    // const total = vs.reduce((acc, a) => acc + a); \n    // return vs.map(v => v/total);\n  }\n\n\n  componentDidMount(){\n\n    const q = getQuery(this.props.time, this.props.poi);\n\n    this.lyr.queryFeatures(q)\n      .then(res => {\n        // console.log(this._getChartData(res));\n        // console.log(res.features[0].attributes)\n        this.setState({\n          data: this._getChartData(res)\n        })\n      })\n      .catch(er => console.log(er));\n  }\n\n  componentDidUpdate(prevProps, prevState){\n    if(prevProps.poi !== this.props.poi || prevProps.time !== this.props.time){\n      this._updateChart()\n    }\n  }\n\n  _updateChart(){\n    const q = getQuery(this.props.time, this.props.poi);\n    this.lyrView.queryFeatures(q)\n      .then(res => {\n        this.setState({\n          data: this._getChartData(res)\n        })\n      })\n      .catch(er => console.log(er))\n\n\n    if(this.highlight){\n      this.highlight.remove();\n    }\n\n    if(this.props.poi){\n      this.lyrView.queryObjectIds(q)\n        .then(res => {\n          this.highlight = this.lyrView.highlight(res)\n        })\n        .catch(er => console.log(er))\n    }\n    \n  }\n\n  render(){\n    const data = {\n      labels: ['Next Wave', 'Upscale Avenues', 'Ethnic Enclaves', 'Other'],\n      datasets: [{\n        label: \"Pattern\",\n        fill: false,\n        data: this.state.data,\n        backgroundColor: [\n          \"rgba(227,69,143, 0.7)\",\n          \"rgba(192,76,253, 0.7)\",\n          \"rgba(239,131,85, 0.7)\",\n          \"#5E2BFF\"\n          // \"rgba(64,249,155, 0.7)\"\n        ]\n      }]\n    }\n\n    return(\n      <div style={{textAlign: \"center\"}}>\n        <div style={{textAlign: \"left\", width: \"100%\"}}>\n          <InfText>Tapestry Profile</InfText>\n          <ExpBtn\n            clearWhite\n            large\n            icon={<GraphBarIcon filled={this.props.active}/>}\n            onClick={this.props.onClick}>\n            Compare\n          </ExpBtn>\n        </div>\n        <Bar\n          data={data}\n          height={250}\n          options={{\n            scales: {\n              xAxes: [{\n                display: true,\n                stacked: true,\n                scaleLabel: {\n                  display: true,\n                  labelString: 'Tapestry Life Mode'\n                },\n                ticks: {\n                  autoSkip: false,\n                  minRotation: 30,\n                  maxRotation: 30,\n                  padding: 0\n                }\n              }],\n              yAxes: [{\n                display: true,\n                stacked: true,\n                scaleLabel: {\n                  display: true,\n                  labelString: 'Fraction'\n                },\n                ticks: {\n                  max: 1\n                }\n              }]\n            }\n          }}\n          getElementAtEvent={this._onBarClick}\n        />\n      </div>\n    )\n  }\n\n}\n\nexport default Demographic;","import React, {Component} from 'react';\nimport MapComponent from './MapComponent';\nimport QuestionHeader from './QuestionHeader';\nimport { CalciteH1, CalciteH4 } from 'calcite-react/Elements';\nimport styled, { css } from 'styled-components';\nimport LiveAreas from './steps/LiveAreas';\nimport Demographic from './steps/Demographic';\nimport './question.css';\n\nconst BigH1 = styled(CalciteH1)`\n  font-size: 3.99758rem;\n  line-height: 3.875rem;\n  margin: 1rem;\n  font-weight: bold;\n  color: white;\n\n`;\nconst Comph4 = styled(CalciteH4)`\n  margin: 0.5rem\n`;\n\nconst initState = [true, false, false];\n\nclass App extends Component{\n\n  constructor(props){\n    super(props);\n    this.onViewLoad = this.onViewLoad.bind(this);\n    this.onListItemClick = this.onListItemClick.bind(this);\n    this._onExploreClick = this._onExploreClick.bind(this);\n    this._onTimeSlide = this._onTimeSlide.bind(this);\n    this._onPoiChange = this._onPoiChange.bind(this);\n    this.state = {\n      loaded: false,\n      active: [false, false, false],\n      explore: true,\n      selPoi: null,\n      selText: null,\n      time: 16\n    }\n  }\n\n  onViewLoad (map, view, blockLyr, blockLyrView){\n    this.mapView = view;\n    this.blockLyr = blockLyr;\n    this.blockLyrView = blockLyrView;\n    this.setState({\n      loaded: true,\n      active: initState\n    })\n  }\n\n  onListItemClick(qKey){\n\n    const next = this.state.active.map( (v,i) => \n      i === qKey ? !v : v\n    )\n\n    this.setState({\n      active: next\n    })\n  }\n\n  _onExploreClick(){\n    this.setState({\n      explore: !this.state.explore\n    })\n  }\n\n  _onTimeSlide(val){\n    let fV = parseFloat(val.target.value);\n    this.setState({\n      time: fV\n    })\n  }\n\n  _onPoiChange(poi, text){\n    this.setState({selPoi: poi, selText: text})\n  }\n\n\n  getQuestionHeader(v, i){\n    const isActive = this.state.active[i];\n    return (<QuestionHeader\n      title={v}\n      onClick={_=>this.onListItemClick(i)}\n      active={isActive}\n      index={i}\n    />)\n  }\n\n  getStepOne(){\n    let header = this.getQuestionHeader('SafeGraph Patterns', 0);\n    if(!this.state.active[0]){\n      return header;\n    }\n    return (\n      <>\n        {header}\n        <div className=\"question-content\">\n          <LiveAreas\n            active={this.state.explore}\n            onClick={this._onExploreClick}\n            value={this.state.time}\n            onSlide={this._onTimeSlide}\n            text={this.state.selText}/>\n        </div>\n      </>\n    )\n  }\n\n  getStepTwo(){\n    let header = this.getQuestionHeader('With Tapestry Segments', 1);\n    if(!this.state.active[1]){\n      return header;\n    }\n    return (\n      <>\n        {header}\n        <div className=\"question-content\">\n          <Demographic\n            lyr={this.blockLyr}\n            lyrView={this.blockLyrView}\n            time={this.state.time / 4}\n            poi={this.state.selPoi}\n          />\n        </div>\n      </>\n    )\n  }\n\n  // getStepThree(){\n  //   let header = this.getQuestionHeader('Cost', 2);\n  //   if(!this.state.active[2]){\n  //     return header;\n  //   }\n  //   return (\n  //     <>\n  //       {header}\n  //       <div className=\"question-content\">\n  //         <BigH1>$126/mo</BigH1>\n  //       </div>\n  //     </>\n  //   )\n  // }\n\n  render(){\n    return(\n      <div>\n        <MapComponent\n          map={this.map}\n          onLoad={this.onViewLoad}\n          active={this.state.active}\n          explore={this.state.explore}\n          time={this.state.time / 4}\n          poi={this.state.selPoi}\n          onPoiChange={this._onPoiChange}\n        />\n        <div style={{position: \"absolute\", top: 15, left: 15, width: \"30%\", maxHeight: 'calc(100vh - 20px)', overflowY: 'scroll'}}>\n          <div style={{}}>\n            {this.getStepOne()}\n            {this.getStepTwo()}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\nimport CalciteThemeProvider from 'calcite-react/CalciteThemeProvider';\nimport { defaults } from 'react-chartjs-2';\nimport { loadCss } from 'esri-loader';\nimport './index.css';\n\nloadCss(\"https://jsdev.arcgis.com/4.11/esri/themes/dark/main.css\");\n\n\ndefaults.global.defaultFontColor = '#ffffff';\ndefaults.global.legend = false;\ndefaults.global.tooltips.enabled = false;\n// defaults.global.events = ['click', 'touchstart', 'touchend']\n// defaults.global.legend.fontColor = '#ffffff';\n\nReactDOM.render(\n  <CalciteThemeProvider>\n    <App/>\n  </CalciteThemeProvider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}